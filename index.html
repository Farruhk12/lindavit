<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>–ö–∞–±–∏–Ω–µ—Ç –ü—Ä–æ–≤–∏–∑–æ—Ä–∞ Lindavit</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      font-family: sans-serif;
      max-width: 700px;
      margin: auto;
      padding: 2rem;
    }
    button {
      margin: 0.25rem;
      padding: 0.5rem 1rem;
      border: 1px solid gray;
      border-radius: 5px;
      cursor: pointer;
    }
    button.active {
      background-color: #4ade80;
      color: white;
    }
    input {
      width: 100%;
      margin-top: 0.5rem;
      margin-bottom: 1rem;
      padding: 0.5rem;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    .card {
      border: 1px solid #e5e7eb;
      border-radius: 10px;
      padding: 1rem;
      margin-bottom: 2rem;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <!-- React & Babel CDN -->
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>

  <!-- React App -->
  <script type="text/babel">
    const { useState } = React;

    function LindavitDashboard() {
      const [name, setName] = useState("");
      const [fio, setFio] = useState("");
      const [number, setNumber] = useState("");
      const [selectedProducts, setSelectedProducts] = useState({});
      const [entries, setEntries] = useState([]);

      const products = [
        "–õ–∏–Ω–¥–∞–≤–∏—Ç –í–∏–∂–Ω –∫–∞–ø—Å ‚Ññ30",
        "–õ–∏–Ω–¥–∞–≤–∏—Ç –î3 –∫–∞–ø–ª–∏ 15000–ú–ï/–º–ª 10–º–ª",
        "–õ–∏–Ω–¥–∞–≤–∏—Ç –î3 –∫–∞–ø—Å 60000–ú–ï ‚Ññ8",
        "–õ–∏–Ω–¥–∞–≤–∏—Ç –¥–ª—è –î–µ—Ç–µ–π —Ç–± –∂–µ–≤–∞—Ç ‚Ññ60",
        "–õ–∏–Ω–¥–∞–≤–∏—Ç –¥–ª—è –ñ–µ–Ω—â–∏–Ω —Ç–± ‚Ññ30",
        "–õ–∏–Ω–¥–∞–≤–∏—Ç –¥–ª—è –ú—É–∂—á–∏–Ω –∫–∞–ø—Å ‚Ññ30",
        "–õ–∏–Ω–¥–∞–≤–∏—Ç –ï 400–º–≥ —Å–æ—Ñ—Ç–∂–µ–ª –∫–∞–ø—Å ‚Ññ30",
        "–õ–∏–Ω–¥–∞–≤–∏—Ç –ñ–µ–ª–µ–∑–æ –∫–∞–ø—Å ‚Ññ30",
        "–õ–∏–Ω–¥–∞–≤–∏—Ç –ñ–µ–ª–µ–∑–æ —Å–∏—Ä–æ–ø 150–º–ª",
        "–õ–∏–Ω–¥–∞–≤–∏—Ç –∫–∞–ª—å—Ü–∏—É–º —Ç–± —à–∏–ø ‚Ññ20",
        "–õ–∏–Ω–¥–∞–≤–∏—Ç –∫–∞—Ä–¥–∏–æ —à–∏–ø.—Ç–± ‚Ññ20",
        "–õ–∏–Ω–¥–∞–≤–∏—Ç –õ–∞–∫—Ç–∞—Ü–∏—è –∫–∞–ø—Å ‚Ññ30",
        "–õ–∏–Ω–¥–∞–≤–∏—Ç –û–º–µ–≥–∞ 3 —Å–æ—Ñ—Ç–∂–µ–ª –∫–∞–ø—Å ‚Ññ30",
        "–õ–∏–Ω–¥–∞–≤–∏—Ç –û—Å—Ç–µ–æ –∫–∞–ø–ª–∏ 20–º–ª",
        "–õ–∏–Ω–¥–∞–≤–∏—Ç –ø–ª—é—Å —Ç–± ‚Ññ30",
        "–õ–∏–Ω–¥–∞–≤–∏—Ç –ü—Ä–µ–≥–Ω–∞ —Ç–± ‚Ññ30",
        "–õ–∏–Ω–¥–∞–≤–∏—Ç –ü—Ä–µ–Ω–∞—Ç–∞–ª –∫–∞–ø—Å ‚Ññ30",
        "–õ–∏–Ω–¥–∞–≤–∏—Ç –° —Ç–± —à–∏–ø 1000–º–≥ ‚Ññ20",
        "–õ–∏–Ω–¥–∞–≤–∏—Ç –° —Ç–± —à–∏–ø 500–º–≥ ‚Ññ20",
        "–õ–∏–Ω–¥–∞–≤–∏—Ç —Å–µ–ª–µ–Ω —Ç–± 200–º–∫–≥/60–º–≥ ‚Ññ30",
        "–õ–∏–Ω–¥–∞–≤–∏—Ç —Å–∏—Ä–æ–ø 150–º–ª",
        "–õ–∏–Ω–¥–∞–≤–∏—Ç —Å–ª–∏–º —Ç–± 200–º–∫–≥ ‚Ññ60",
        "–õ–∏–Ω–¥–∞–≤–∏—Ç –¶–∏–Ω–∫ –∫–∞–ø–ª–∏ 20–º–≥/–º–ª 15–º–ª",
        "–õ–∏–Ω–¥–∞–≤–∏—Ç –¶–∏—Ä–æ–Ω —Å—Ç–∏–∫ —Å–∞—à–µ 14–º–≥/50–º–≥ 10–º–ª ‚Ññ10",
        "–õ–∏–Ω–¥–∞–∫–∞–ª—Ü –∞–∫—Ç–∏–≤ —Ç–± ‚Ññ30",
        "–õ–∏–Ω–¥–∞–∫–∞–ª—Ü —Å–∏—Ä–æ–ø 150–º–ª",
        "–õ–∏–Ω–¥–∞–ú–∏—à–∫–∏ –ø–∞—Å—Ç–∏–ª–∫–∏ –∂–µ–≤–∞—Ç ‚Ññ60",
        "–õ–∏–Ω–¥–∞—Ü–∏–Ω–∫ —Ç–± 20–º–≥ ‚Ññ25"
      ];

      const handleProductClick = (product) => {
        setSelectedProducts((prev) => ({
          ...prev,
          [product]: prev[product] ? prev[product] + 1 : 1
        }));
      };

      const handleCopy = async () => {
        try {
          const report = Object.entries(selectedProducts)
            .map(([product, qty]) => `${product} ‚Äî ${qty} —à—Ç.`)
            .join("\n");
          if (!report) return alert("–°–ø–∏—Å–æ–∫ –ø—É—Å—Ç.");
          await navigator.clipboard.writeText(report);
          alert("‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!");
        } catch (err) {
          alert("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å.");
        }
      };

      const handleSubmit = () => {
        if (name && fio && number && Object.keys(selectedProducts).length > 0) {
          const productArray = Object.entries(selectedProducts).map(
            ([product, qty]) => ({ product, qty })
          );

          // ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Google –¢–∞–±–ª–∏—Ü—É
          fetch("https://script.google.com/macros/s/AKfycbyDnSjHHMoFgjfJ4wQc66E8ru9HzGvqqoYuNgncLhOhV8rwYr65shRdHmg-5XApVMoSlg/exec", {
            method: "POST",
            mode: "no-cors",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              name,
              fio,
              number,
              products: productArray
            })
          });

          const newEntry = {
            name,
            fio,
            number,
            products: selectedProducts,
            date: new Date().toLocaleDateString()
          };

          setEntries([...entries, newEntry]);
          setSelectedProducts({});
          alert("‚úÖ –û—Ç—á—ë—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!");
        } else {
          alert("‚ö†Ô∏è –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–¥—É–∫—Ç—ã.");
        }
      };

      return (
        <div>
          <h1>–ö–∞–±–∏–Ω–µ—Ç –ü—Ä–æ–≤–∏–∑–æ—Ä–∞ Lindavit</h1>
          <div className="card">
            <label>–ù–∞–∑–≤–∞–Ω–∏–µ –∞–ø—Ç–µ–∫–∏:</label>
            <input value={name} onChange={(e) => setName(e.target.value)} placeholder="–ê–ø—Ç–µ–∫–∞ / –§–∏–ª–∏–∞–ª" />

            <label>–§–ò–û –ø—Ä–æ–≤–∏–∑–æ—Ä–∞:</label>
            <input value={fio} onChange={(e) => setFio(e.target.value)} placeholder="–§–ò–û –ø–æ–ª–Ω–æ—Å—Ç—å—é" />

            <label>–ù–æ–º–µ—Ä –ø—Ä–æ–≤–∏–∑–æ—Ä–∞:</label>
            <input value={number} onChange={(e) => setNumber(e.target.value)} placeholder="–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞" />

            <label>–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–¥—É–∫—Ç—ã:</label>
            <div>
              {products.map((product) => (
                <button
                  key={product}
                  onClick={() => handleProductClick(product)}
                  className={selectedProducts[product] ? "active" : ""}
                >
                  {product} {selectedProducts[product] ? `(${selectedProducts[product]})` : ""}
                </button>
              ))}
            </div>

            <div style={{ marginTop: "1rem" }}>
              <button onClick={handleSubmit}>üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
              <button onClick={handleCopy}>üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
            </div>
          </div>

          <h2>–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:</h2>
          <ul>
            {entries.map((entry, i) => (
              <li key={i}>
                <strong>{entry.fio}</strong> ({entry.number}) –∏–∑ <em>{entry.name}</em> —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–ª:
                <ul>
                  {Object.entries(entry.products).map(([p, q], j) => (
                    <li key={j}>{p} ‚Äî {q} —à—Ç.</li>
                  ))}
                </ul>
                <small>{entry.date}</small>
              </li>
            ))}
          </ul>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<LindavitDashboard />);
  </script>
</body>
</html>
