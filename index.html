<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>–ö–∞–±–∏–Ω–µ—Ç –ü—Ä–æ–≤–∏–∑–æ—Ä–∞ Lindavit</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      font-family: sans-serif;
      padding: 1rem;
      margin: 0;
      background-color: #fff;
      color: #111;
    }

    h1 {
      font-size: 1.5rem;
      text-align: center;
      margin-bottom: 1.5rem;
    }

    label {
      font-weight: 500;
      font-size: 0.95rem;
    }

    input {
      width: 100%;
      padding: 0.7rem;
      margin: 0.4rem 0 1rem 0;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 1rem;
    }

    .product-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.8rem;
    }

    .product-name {
      flex: 1;
      font-size: 0.95rem;
    }

    .counter {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .counter button {
      width: 36px;
      height: 36px;
      font-size: 20px;
      font-weight: bold;
      border: none;
      border-radius: 8px;
      background-color: #e0e0e0;
      cursor: pointer;
    }

    .counter span {
      width: 24px;
      text-align: center;
      font-size: 1.1rem;
    }

    button.submit {
      width: 100%;
      padding: 0.8rem;
      font-size: 1rem;
      background-color: #38bdf8;
      color: white;
      border: none;
      border-radius: 10px;
      margin-top: 1.5rem;
      cursor: pointer;
    }

    ul {
      padding-left: 1rem;
      font-size: 0.9rem;
    }

    em {
      font-style: italic;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>

  <script type="text/babel">
    const { useState, useEffect } = React;

    function LindavitDashboard() {
      const [name, setName] = useState(localStorage.getItem("pharmacyName") || "");
      const [fio, setFio] = useState(localStorage.getItem("pharmacyFIO") || "");
      const [number, setNumber] = useState(localStorage.getItem("pharmacyNumber") || "");
      const [selectedProducts, setSelectedProducts] = useState({});
      const [entries, setEntries] = useState([]);

      const products = [
        "–õ–∏–Ω–¥–∞–≤–∏—Ç –í–∏–∂–Ω –∫–∞–ø—Å ‚Ññ30", "–õ–∏–Ω–¥–∞–≤–∏—Ç –î3 –∫–∞–ø–ª–∏ 15000–ú–ï/–º–ª 10–º–ª", "–õ–∏–Ω–¥–∞–≤–∏—Ç –î3 –∫–∞–ø—Å 60000–ú–ï ‚Ññ8",
        "–õ–∏–Ω–¥–∞–≤–∏—Ç –¥–ª—è –î–µ—Ç–µ–π —Ç–± –∂–µ–≤–∞—Ç ‚Ññ60", "–õ–∏–Ω–¥–∞–≤–∏—Ç –¥–ª—è –ñ–µ–Ω—â–∏–Ω —Ç–± ‚Ññ30", "–õ–∏–Ω–¥–∞–≤–∏—Ç –¥–ª—è –ú—É–∂—á–∏–Ω –∫–∞–ø—Å ‚Ññ30",
        "–õ–∏–Ω–¥–∞–≤–∏—Ç –ï 400–º–≥ —Å–æ—Ñ—Ç–∂–µ–ª –∫–∞–ø—Å ‚Ññ30", "–õ–∏–Ω–¥–∞–≤–∏—Ç –ñ–µ–ª–µ–∑–æ –∫–∞–ø—Å ‚Ññ30", "–õ–∏–Ω–¥–∞–≤–∏—Ç –ñ–µ–ª–µ–∑–æ —Å–∏—Ä–æ–ø 150–º–ª",
        "–õ–∏–Ω–¥–∞–≤–∏—Ç –∫–∞–ª—å—Ü–∏—É–º —Ç–± —à–∏–ø ‚Ññ20", "–õ–∏–Ω–¥–∞–≤–∏—Ç –∫–∞—Ä–¥–∏–æ —à–∏–ø.—Ç–± ‚Ññ20", "–õ–∏–Ω–¥–∞–≤–∏—Ç –õ–∞–∫—Ç–∞—Ü–∏—è –∫–∞–ø—Å ‚Ññ30",
        "–õ–∏–Ω–¥–∞–≤–∏—Ç –û–º–µ–≥–∞ 3 —Å–æ—Ñ—Ç–∂–µ–ª –∫–∞–ø—Å ‚Ññ30", "–õ–∏–Ω–¥–∞–≤–∏—Ç –û—Å—Ç–µ–æ –∫–∞–ø–ª–∏ 20–º–ª", "–õ–∏–Ω–¥–∞–≤–∏—Ç –ø–ª—é—Å —Ç–± ‚Ññ30",
        "–õ–∏–Ω–¥–∞–≤–∏—Ç –ü—Ä–µ–≥–Ω–∞ —Ç–± ‚Ññ30", "–õ–∏–Ω–¥–∞–≤–∏—Ç –ü—Ä–µ–Ω–∞—Ç–∞–ª –∫–∞–ø—Å ‚Ññ30", "–õ–∏–Ω–¥–∞–≤–∏—Ç –° —Ç–± —à–∏–ø 1000–º–≥ ‚Ññ20",
        "–õ–∏–Ω–¥–∞–≤–∏—Ç –° —Ç–± —à–∏–ø 500–º–≥ ‚Ññ20", "–õ–∏–Ω–¥–∞–≤–∏—Ç —Å–µ–ª–µ–Ω —Ç–± 200–º–∫–≥/60–º–≥ ‚Ññ30", "–õ–∏–Ω–¥–∞–≤–∏—Ç —Å–∏—Ä–æ–ø 150–º–ª",
        "–õ–∏–Ω–¥–∞–≤–∏—Ç —Å–ª–∏–º —Ç–± 200–º–∫–≥ ‚Ññ60", "–õ–∏–Ω–¥–∞–≤–∏—Ç –¶–∏–Ω–∫ –∫–∞–ø–ª–∏ 20–º–≥/–º–ª 15–º–ª", "–õ–∏–Ω–¥–∞–≤–∏—Ç –¶–∏—Ä–æ–Ω —Å—Ç–∏–∫ —Å–∞—à–µ 14–º–≥/50–º–≥ 10–º–ª ‚Ññ10",
        "–õ–∏–Ω–¥–∞–∫–∞–ª—Ü –∞–∫—Ç–∏–≤ —Ç–± ‚Ññ30", "–õ–∏–Ω–¥–∞–∫–∞–ª—Ü —Å–∏—Ä–æ–ø 150–º–ª", "–õ–∏–Ω–¥–∞–ú–∏—à–∫–∏ –ø–∞—Å—Ç–∏–ª–∫–∏ –∂–µ–≤–∞—Ç ‚Ññ60", "–õ–∏–Ω–¥–∞—Ü–∏–Ω–∫ —Ç–± 20–º–≥ ‚Ññ25"
      ];

      const increaseQty = (product) => {
        setSelectedProducts((prev) => ({
          ...prev,
          [product]: (prev[product] || 0) + 1
        }));
      };

      const decreaseQty = (product) => {
        setSelectedProducts((prev) => {
          const current = prev[product] || 0;
          if (current <= 1) {
            const copy = { ...prev };
            delete copy[product];
            return copy;
          }
          return { ...prev, [product]: current - 1 };
        });
      };

      const handleSubmit = () => {
        if (name && fio && number && Object.keys(selectedProducts).length > 0) {
          localStorage.setItem("pharmacyName", name);
          localStorage.setItem("pharmacyFIO", fio);
          localStorage.setItem("pharmacyNumber", number);

          const productArray = Object.entries(selectedProducts).map(
            ([product, qty]) => ({ product, qty })
          );

          fetch("https://script.google.com/macros/s/AKfycbyDnSjHHMoFgjfJ4wQc66E8ru9HzGvqqoYuNgncLhOhV8rwYr65shRdHmg-5XApVMoSlg/exec", {
            method: "POST",
            mode: "no-cors",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              name,
              fio,
              number,
              products: productArray
            })
          });

          const newEntry = {
            name,
            fio,
            number,
            products: selectedProducts,
            date: new Date().toLocaleDateString()
          };

          setEntries([...entries, newEntry]);
          setSelectedProducts({});
          alert("‚úÖ –û—Ç—á—ë—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!");
        } else {
          alert("‚ö†Ô∏è –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–¥—É–∫—Ç—ã.");
        }
      };

      return (
        <div>
          <h1>–ö–∞–±–∏–Ω–µ—Ç –ü—Ä–æ–≤–∏–∑–æ—Ä–∞ Lindavit</h1>

          <label>–ù–∞–∑–≤–∞–Ω–∏–µ –∞–ø—Ç–µ–∫–∏:</label>
          <input value={name} onChange={(e) => setName(e.target.value)} placeholder="–ê–ø—Ç–µ–∫–∞ / –§–∏–ª–∏–∞–ª" />

          <label>–§–ò–û –ø—Ä–æ–≤–∏–∑–æ—Ä–∞:</label>
          <input value={fio} onChange={(e) => setFio(e.target.value)} placeholder="–§–ò–û –ø–æ–ª–Ω–æ—Å—Ç—å—é" />

          <label>–ù–æ–º–µ—Ä –ø—Ä–æ–≤–∏–∑–æ—Ä–∞:</label>
          <input value={number} onChange={(e) => setNumber(e.target.value)} placeholder="–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞" />

          <label>–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–¥—É–∫—Ç—ã:</label>
          <div>
            {products.map((product) => (
              <div key={product} className="product-row">
                <div className="product-name">{product}</div>
                <div className="counter">
                  <button onClick={() => decreaseQty(product)}>-</button>
                  <span>{selectedProducts[product] || 0}</span>
                  <button onClick={() => increaseQty(product)}>+</button>
                </div>
              </div>
            ))}
          </div>

          <button className="submit" onClick={handleSubmit}>üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<LindavitDashboard />);
  </script>
</body>
</html>
